<nz-page-header class="mobile-header" nzTitle="Pacientes Agendados"></nz-page-header>
<nz-divider></nz-divider>
<form nz-form nzLayout="vertical" [formGroup]="filterSchedulesForm" (ngSubmit)="getProfissionalSchedules()">
  <h1>Filtros</h1>
  <nz-row nzGutter="12" style="align-items: center;">
    <nz-col nzSm="6" nzXs="24" style="display: flex; align-items: center;">
      <nz-switch formControlName="isCanceled"></nz-switch>
      <span style="margin-left: 4px;">Consultas canceladas</span>
    </nz-col>
  </nz-row>

  <nz-row>
    <nz-col class="button-group" nzSpan="24">
      <button
        nz-button
        nzType="primary"
        nzSize="large"
        type="submit"
        [disabled]="isLoading"
        [nzLoading]="isLoading"
      >
        <i nz-icon nzType="search" nzTheme="outline"></i>
        Filtrar
      </button>

    </nz-col>
  </nz-row>
</form>

<nz-spin [nzSpinning]="isLoading">
  <nz-divider
    nzText="Encontrados: {{ totalSchedules }} "
    nzOrientation="left"
    *ngIf="!!totalSchedules"></nz-divider>
  <div nz-row class="table-responsive">
    <nz-table
      nzShowSizeChanger
      [nzData]="schedulesData"
      nzSize="default"
      [nzFrontPagination]="false"
      [nzShowPagination]="showPagination"
      [nzTotal]="totalSchedules"
      [nzPageIndex]="pageIndex"
      [nzPageSize]="pageSize"
      (nzPageIndexChange)="onPageIndexChange($event)"
      (nzPageSizeChange)="onPageSizeChange($event)"
    >


      <thead>
      <tr>
        <th>Ações</th>
        <th>Paciente</th>
        <th>Data da consulta</th>
        <th>Responsavel pela consulta</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let schedule of schedulesData">
        <td>
          <ng-container *ngIf="!schedule.isCanceled; else canceled">
            <button
              nz-button
              nzShape="circle"
              title="Cancelar consulta"
              style="margin-left: 5px"
              nz-tooltip
              [nzTooltipTitle]="'Cancelar consulta'"
              (click)="handleCancelSchedule(schedule.appointmentId, true)"
            >
              <span nz-icon nzType="close-circle" nzTheme="outline"></span>
            </button>
          </ng-container>
          <ng-template #canceled>
            <span>Consulta cancelada</span>
          </ng-template>
        </td>

        <td>{{ schedule.pacientName }}</td>
        <td>{{ schedule.appointmentDateTime | date:'dd/MM/yyyy HH:mm' }}</td>
        <td>{{ schedule.profissionalName }}</td>

      </tr>
      </tbody>
    </nz-table>
  </div>

</nz-spin>


